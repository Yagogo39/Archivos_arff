<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ARFF | Division</title>
    <style>
        body {
            font-family: Tahoma, Geneva, Verdana, sans-serif;
            background-color: #000000;
            color: #ffffff;
            padding: 40px 20px;
        }
        .container {
            background: #000000;
            padding: 30px;
            max-width: 1200px;
            margin: auto;
            transition: all 0.3s ease;
        }

        h2, h3, h4 {
            text-align: center;
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 5px;
        }
        h3, h4 {
             font-weight: 300;
             font-size: 1.2rem;
        }

        .content-columns {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding: 0 20px;
        }
        .info-box {
            flex: 1;
            background-color: #1a1a1a;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            color: #ccc;
            text-align: left;
            border: 1px solid #333;
        }
        .info-box strong {
            color: #e2a128;
            display: block;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .upload-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            background-color: #2e2f30;
        }
        input[type="file"] {
            display: none;
        }
        .custom-file-upload {
            border: 2px solid #e2a128;
            color: #e2a128;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            margin-bottom: 10px;
            font-weight: 500;
            background-color: #000000;
        }
        .custom-file-upload:hover {
            background-color: #402600;
        }
        #file-name {
            color: #ccc !important;
        }

        .btn {
            background-color: #e2a128;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.1s;
        }
        .btn:hover {
            background-color: #e2a128;
            transform: translateY(-1px);
        }
        .btn-success {
             background-color: #e2a128;
        }
        .btn-success:hover {
             background-color: #e2a128;
        }


        .data-visualization-section {
            margin-top: 40px;
        }
        .table-container {
            max-height: 500px;
            overflow-y: auto;
            overflow-x: auto;
            border: 1px solid #333;
            border-radius: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            min-width: 800px;
        }
        th {
            background-color: #e2a128;
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        td {
            color: #ccc;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
        }
        tr:nth-child(even) {
            background-color: #1a1a1a;
        }
        tr:hover {
            background-color: #e2a128;
        }

        .descargas {
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid #333;
            margin-top: 30px;
        }
        .descargas a {
            text-decoration: none;
            display: inline-block;
            background: #e2a128;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            margin: 0 10px;
            font-weight: 600;
            transition: background 0.3s;
        }
        .descargas a:hover {
            background: #e2a128;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Division del DataSet</h2>

        <h4>Se debe separar el DataSet en los diferentes subconjuntos necesarios para realizar los procesos de entrenamiento, validacion y pruebas. Sklearn implementa la funcion split_train_test.</h4>

        <div class="content-columns">
            <div class="info-box">
                <strong>Subconjuntos</strong>
                <p>La divisi贸n m谩s com煤n es en Entrenamiento, Validaci贸n y Pruebas. Esto asegura que el modelo se pruebe con datos que nunca ha visto.</p>
                <ul>
                    <li><b>Entrenamiento.</b>Se usa para ajustar los par谩metros y pesos del modelo.</li>
                    <li><b>Validacion.</b>Se usa para evaluar el rendimiento del modelo durante la fase de entrenamiento, ayudando a ajustar y optimizar el modelo.</li>
                    <li><b>Pruebas.</b>Se usa al final, para una evaluaci贸n imparcial del rendimiento final.</li>
                </ul>
            </div>
            <div class="info-box">
                <strong>Shuffle y Stratify</strong>
                <p>Sklearn implementa la funcion train_test_split, sin embargo esta funcion por defecto realiza un particionado del DataSet aleatorio para cada vez que se ejecuta el script.Aun agregando una semilla fija y"aleatoria", cada vez que se cargue de nuevo el DataSet se generan nuevos subconjuntos esto puede ocacionar que despues de muchos intentos "vea" todo el DataSet.</p>

                <li><b>Shuffle.</b>Proceso de reordenar aleatoriamente los registros dentro de un conjunto de datos</li>
                <li><b>Stratify.</b>Dividir un conjunto de datos grande y heterogeneo en subgrupos mas peque帽os y homogeneos.</li>
            </div>
        </div>

        <div class="upload-section">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <label for="file-upload" class="custom-file-upload">
                    Seleccionar Archivo (.arff)
                </label>
                <input id="file-upload" type="file" name="file" required onchange="document.getElementById('file-name').innerText = this.files[0].name">
                <span id="file-name" style="margin-left: 15px; color: #ccc;">No se ha seleccionado ning煤n archivo.</span>
                <button type="submit" class="btn"> Cargar Dataset</button>
            </form>
        </div>

        {% if mensaje %}
            <div class="alert alert-info">{{ mensaje }}</div>
        {% endif %}

        {% if df_html %}
        <div class="data-visualization-section">
            <h3 style="margin-top: 0;">Vista Previa del Dataset Cargado</h3>

            <div class="table-container">
                {{ df_html|safe }}
            </div>
        </div>
        {% endif %}

        <div style="text-align:center; margin-bottom: 20px;">
            <form method="post">
                {% csrf_token %}
                <button name="particionar" type="submit" class="btn btn-success">Particionar Dataset</button>
            </form>
        </div>

        {% if particion_realizada %} 
        <div class="descargas">
             <h4 style="color: #ffffff; margin-bottom: 15px;">Resultados de la Partici贸n</h4>
             <p style="color: #ccc; margin-bottom: 20px;">
                <li>Total: <b>{{total_datos}}</b> registros</li>
                <li>Entrenamiento: <b>{{ train_len }}</b> registros </li>
                <li>Validaci贸n: <b>{{ val_len }}</b> registros </li>
                <li>Pruebas: <b>{{ test_len }}</b> registros </li>
                
             </p>
             <a href="{% url 'descargar_csv' tipo='train' %}" class="btn-success">Descargar Entrenamiento</a>
             <a href="{% url 'descargar_csv' tipo='val' %}" class="btn-success">Descargar Validacion</a>
             <a href="{% url 'descargar_csv' tipo='test' %}" class="btn-success">Descargar Test</a>
        </div>
        {% endif %}
    </div>
</body>
</html>